html
  head
    include head.pug

    script.
      window.onload = () => {
        document.getElementById('loading').style.display = "none"
        document.getElementById('download').onclick = () => {
          console.log('down')

          document.getElementById('logo').style.display = "block"
          document.getElementById('genby').style.display = "inline"
          document.getElementById('download').disabled = true
          document.getElementById('box').classList.remove('box')
          html2canvas(document.getElementById('box'),{
            onrendered: canvas => {
              const a = document.createElement('a');
              a.title = "my title text";
              a.href = canvas.toDataURL();
              a.download = `${document.getElementById('title').innerText}.png`
              a.click()
              document.getElementById('logo').style.display = "none"
              document.getElementById('genby').style.display = "none"
              document.getElementById('box').classList.add('box')
            }
          })
        }
      }
    style(type="text/css").
      .pad {padding: 16px;}
      .box {
        overflow-x: scroll;
        max-width: 100%;
      }
  body
    div#loading(style="position: fixed; width: 100%; height: 100%; background: #ffffffCC; top: 0; left: 0; z-index: 1;")
      span(style="font-size: 24pt; top: calc(50% - 12pt); position: absolute; left: calc(50% - 80px); color: black;") 読み込み中
    div.uk-section
      div.uk-container.uk-container-expand
        a(href="/")
          img(src="/sus2image.png",style="height: 128px;")
        div#box(style="width: fit-content; margin-top: 16px; background: #ffffff;").pad
          span(style="font-size: 28pt;")#title= meta.TITLE
          span(style="font-size: 16pt; margin-left: 16px;")= meta.DESIGNER
          img(src="/sus2image.png",style="margin-top: 5px; height: 28pt; float: right; display: none;")#logo
          span(style="font-size: 16pt; margin-top: 9px; margin-right: 6px; float: right; font-family: sans-serif; display: none;")#genby Generated by
          div#score(style=`display: flex; align-items: flex-end; margin-top: 16px;`)
            - for (let i = 0; i < Math.ceil(height/2304); i++)
              div(style="margin: 0 16px; width: 68px; height: fit-content;")
                div(style="width: 68px; margin-left: auto; overflow: hidden; height: 576px;")
                  img(src=`/svg/${image}.svg`, style=`vertical-align: bottom; width: 68px; position: relative; top: ${-(height / 4 - 576 * i - 584 + 8)}px;`)
        button(style="margin-left: 4px; margin-top: 4px;")#download.uk-button.uk-button-primary 画像を保存
